# created by cif2lammps

units     real
boundary  p p p
dimension 3
newton    on
#
atom_style       full
pair_style    hybrid/overlay lj/cut 13.0 coul/long 13.0 morse 13.0

# Read coordinates, charges and potentials
read_data    Zn2MIm_equilibrated_inside_grid.lmp
include      forcefield_nbzifff_DMSO_real.lmp


# Setup neighbor style
neighbor 2.0 bin	
neigh_modify every 1 delay 0 check yes
 
#
variable dt            equal 0.5
variable temp          equal 298.0
variable press         equal 1.0
variable tdamp         equal 100*${dt}
variable pdamp         equal 1000*${dt}
variable RandomSeed    equal 123456789
variable nprint        equal 100
variable ndump         equal 4*${nprint}


# groups for RDF
group Nitrogen     type 3
group Zinc         type 1
group Carbon       type 2 6 7 
group ZIF          type 1 2 3 4 5 6 7 8 9 
group solvent      type 10 11 12


group2ndx index.data 

#
thermo_style  custom step etotal evdwl ecoul temp ebond eangle edihed eimp press vol cella cellb cellc
thermo_modify flush yes
thermo   ${nprint}

restart 150000 zif.restart
#
timestep ${dt}

#---------------------------------------------------------------
### ENERGY MINIMIZATION
min_style        cg
minimize         1.0e-4 1.0e-4 1000 100000

write_data After_min.lmps

#---------------------------------------------------------------
### EQUILIBRATION 
#
fix NVT_ramp all nvt temp 10 ${temp} ${tdamp} 
dump 55 all custom 500 step5.lammpstrj id type mol x y z
dump_modify 55 sort id
run 50000
undump 55
unfix NVT_ramp
#
write_data After_NVT_ramp.lmps
##
fix NVT all nvt temp ${temp} ${temp} ${tdamp}  
dump 66 all custom 500 step6.lammpstrj id type mol x y z
dump_modify 66 sort id
run 50000
undump 66
unfix NVT
#
write_data After_NVT.lmps
#
fix NPT_eq1 all npt temp ${temp} ${temp} ${tdamp} iso ${press} ${press} ${pdamp} 
dump 77 all custom 500 step7.lammpstrj id type mol x y z
dump_modify 77 sort id
run 50000
undump 77
unfix NPT_eq1
#
write_data After_NPT_eq1.lmps

#---------------------------------------------------------------
### PRODUCTION

fix 22 all plumed plumedfile plumed.inp outfile plumed.out

fix NPT all npt temp ${temp} ${temp} ${tdamp} iso ${press} ${press} ${pdamp}
dump TRAJ all custom 500 npt.lammpstrj id type mol x y z
dump_modify TRAJ sort id
run 3000000
unfix NPT
undump TRAJ
unfix 22

write_data After_NPT.lmps

